<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiaoxu.dao.AdmUserServiceMapper">

    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Nov 26 10:11:39 CST 2019.
        -->
        id, name, account, age, gender, user_img, telephone, status, follows, fans, sign, online_status
    </sql>

    <select id="selectByAccount" resultType="java.util.Map">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Nov 17 10:11:14 CST 2019.
        -->
        select
        *
        from adm_user au
        left join adm_user_password aup
        on  au.id=aup.adm_id
        where au.account = #{account,jdbcType=VARCHAR} and aup.adm_password = #{password,jdbcType=VARCHAR}
    </select>
    <update id="amdUserOffline">
        update adm_user
        set
        online_status = 2
        where id = #{userId,jdbcType=INTEGER}
    </update>

    <update id="amdUserOnline">
        update adm_user
        set
        online_status = 1
        where id = #{userId,jdbcType=INTEGER}
    </update>
    <insert id="insertServiceLog" parameterType="java.util.Map" keyProperty="id" useGeneratedKeys="true">
        insert into service_log (
        id,
        user_id,
        user_telephone,
        service_url,
        service_name,
        req_info,
        result_desc,
        create_time
        )
        values (
        #{id,jdbcType=INTEGER},
        #{user_id,jdbcType=INTEGER},
        #{user_telephone,jdbcType=VARCHAR},
        #{service_url,jdbcType=VARCHAR},
        #{service_name,jdbcType=VARCHAR},
        #{req_info,jdbcType=VARCHAR},
        #{result_desc,jdbcType=VARCHAR},
        #{create_time,jdbcType=TIMESTAMP}
        )
    </insert>
    <select id="selectServiceLog" resultType="java.util.Map">
        select
        *
        from service_log
    </select>

    <insert id="insertErrorsLog" parameterType="java.util.Map" keyProperty="id" useGeneratedKeys="true">
        insert into errors_log
        (
        id,
        errors_info,
        create_time
        )
        values
        (
        #{id,jdbcType=INTEGER},
        #{errors_info,jdbcType=LONGVARCHAR},
        #{create_time,jdbcType=TIMESTAMP}
        )
    </insert>

    <select id="selectErrorsLog" resultType="java.util.Map">
        select
        *
        from errors_log
    </select>

    <insert id="doReport" parameterType="java.util.Map" keyProperty="id" useGeneratedKeys="true">
        insert into black_list
        (
        id,
        user_id,
        info,
        create_time,
        status
        )
        values
        (
        #{id,jdbcType=INTEGER},
        #{user_id,jdbcType=INTEGER},
        #{info,jdbcType=LONGVARCHAR},
        #{create_time,jdbcType=TIMESTAMP},
        #{status,jdbcType=VARCHAR}
        )
    </insert>

    <select id="getReportList" resultType="java.util.Map">
        select
        bl.id,
        bl.user_id,
        bl.info,
        bl.create_time,
        ui.status
        from black_list bl
        left join user_info ui
        on bl.user_id = ui.id
    </select>
</mapper>